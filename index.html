<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Robins-Wang Variance Estimation for Multiply Imputed Data Created with mice • rw</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Robins-Wang Variance Estimation for Multiply Imputed Data Created with mice">
<meta name="description" content="Computes the Robins-Wang variance estimator for analyses performed on datasets that have been multiply imputed using the mice package. This method provides an alternative to Rubin's rules, offering improved variance estimation under certain missing-data conditions.">
<meta property="og:description" content="Computes the Robins-Wang variance estimator for analyses performed on datasets that have been multiply imputed using the mice package. This method provides an alternative to Rubin's rules, offering improved variance estimation under certain missing-data conditions.">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">rw</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="rw">rw<a class="anchor" aria-label="anchor" href="#rw"></a>
</h1></div>
<!-- badges: start -->

<p>The purpose of the rw package is to compute Robins-Wang variance estimates for multiply imputed data analyses.</p>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>This package requires the development version of mice with the <code>tasks</code> argument:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">remotes</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"amices/mice"</span><span class="op">)</span></span></code></pre></div>
<p>Then you can install the development version of rw like so:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">remotes</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"LucyMcGowan/rw"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="example">Example<a class="anchor" aria-label="anchor" href="#example"></a>
</h2>
<p>The first step is to impute your data using mice. Note that currently only <code>method = "norm"</code> and <code>method = "logreg"</code> are supported. When using the <code>mice</code> function, you must set the parameter <code>task = "train"</code> in order to pass the necessary parts to our subsequent functions. For example, see below. We will use the <code>nhanes</code> data from the mice package and perform multiple imputation using the <code>norm</code> method.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://lucymcgowan.github.io/rw/">rw</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/amices/mice" class="external-link">mice</a></span><span class="op">)</span></span>
<span><span class="va">imp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://amices.org/mice/reference/mice.html" class="external-link">mice</a></span><span class="op">(</span><span class="va">nhanes</span>, method <span class="op">=</span> <span class="st">"norm"</span>, m <span class="op">=</span> <span class="fl">5</span>, tasks <span class="op">=</span> <span class="st">"train"</span>, print <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p>Now, suppose we want to fit a model predicting <code>bmi</code> from <code>age</code> and <code>hyp</code>. The <code>with_rw</code> function allows this, where the first argument is the imputation object from the <code>mice</code> function above and the second is the model expression. Note that currently outcome models must be Gaussian or Binomial.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/with_rw.html">with_rw</a></span><span class="op">(</span><span class="va">imp</span>, <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">bmi</span> <span class="op">~</span> <span class="va">age</span> <span class="op">+</span> <span class="va">hyp</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Finally, we can pool the results from the fit object and calculate the Robins-Wang variance using the <code>pool_rw</code> function</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/pool_rw.html">pool_rw</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ── Robins-Wang Pooled Results ──────────────────────────────────────────────────</span></span>
<span><span class="co">#&gt; Number of imputations: 5</span></span>
<span><span class="co">#&gt; Sample size: 25</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;          term estimate std.error statistic p.value conf.low conf.high</span></span>
<span><span class="co">#&gt; 1 (Intercept)   28.617     51.88   0.55161  0.5812   -73.06    130.30</span></span>
<span><span class="co">#&gt; 2         age   -3.058     23.33  -0.13105  0.8957   -48.79     42.67</span></span>
<span><span class="co">#&gt; 3         hyp    3.204     34.36   0.09325  0.9257   -64.13     70.54</span></span></code></pre></div>
<p>Let’s compare this result to using Rubin’s rules.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit_rr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">imp</span>, <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">bmi</span> <span class="op">~</span> <span class="va">age</span> <span class="op">+</span> <span class="va">hyp</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://amices.org/mice/reference/pool.html" class="external-link">pool</a></span><span class="op">(</span><span class="va">fit_rr</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt;          term  estimate std.error statistic        df      p.value</span></span>
<span><span class="co">#&gt; 1 (Intercept) 28.616514  3.403986  8.406766 11.558784 2.911276e-06</span></span>
<span><span class="co">#&gt; 2         age -3.057764  1.436188 -2.129083  8.956052 6.226165e-02</span></span>
<span><span class="co">#&gt; 3         hyp  3.203510  2.961103  1.081864  7.473962 3.129791e-01</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="giganti--shepherd-example">Giganti &amp; Shepherd Example<a class="anchor" aria-label="anchor" href="#giganti--shepherd-example"></a>
</h2>
<p>Below is an example to replicate the Giganti &amp; Shepherd (2020) results.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">meth</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://amices.org/mice/reference/make.method.html" class="external-link">make.method</a></span><span class="op">(</span><span class="va">giganti_data</span><span class="op">)</span></span>
<span><span class="va">meth</span><span class="op">[</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">""</span></span>
<span><span class="va">meth</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"D"</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"norm"</span>, <span class="st">"logreg"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">pred</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://amices.org/mice/reference/make.predictorMatrix.html" class="external-link">make.predictorMatrix</a></span><span class="op">(</span><span class="va">giganti_data</span><span class="op">)</span></span>
<span><span class="va">pred</span><span class="op">[</span>,<span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">pred</span><span class="op">[</span><span class="st">"A"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"X1"</span>, <span class="st">"X2"</span>, <span class="st">"A.star"</span>, <span class="st">"D.star"</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span><span class="va">pred</span><span class="op">[</span><span class="st">"D"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"X1"</span>, <span class="st">"X2"</span>, <span class="st">"A.star"</span>, <span class="st">"D.star"</span>, <span class="st">"A"</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span></span>
<span><span class="va">imp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://amices.org/mice/reference/mice.html" class="external-link">mice</a></span><span class="op">(</span><span class="va">giganti_data</span>, m <span class="op">=</span> <span class="fl">10</span>, method <span class="op">=</span> <span class="va">meth</span>, predictorMatrix <span class="op">=</span> <span class="va">pred</span>,</span>
<span>            print <span class="op">=</span> <span class="cn">FALSE</span>, tasks <span class="op">=</span> <span class="st">"train"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">fit_rw</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/with_rw.html">with_rw</a></span><span class="op">(</span><span class="va">imp</span>, <span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span><span class="va">D</span> <span class="op">~</span> <span class="va">A</span>, subset <span class="op">=</span> <span class="va">A</span> <span class="op">&gt;</span> <span class="fl">2</span>, family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">binomial</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">pooled</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/pool_rw.html">pool_rw</a></span><span class="op">(</span><span class="va">fit_rw</span><span class="op">)</span></span>
<span><span class="va">pooled</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ── Robins-Wang Pooled Results ──────────────────────────────────────────────────</span></span>
<span><span class="co">#&gt; Number of imputations: 10</span></span>
<span><span class="co">#&gt; Sample size: 4000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;          term estimate std.error statistic   p.value conf.low conf.high</span></span>
<span><span class="co">#&gt; 1 (Intercept)  -3.4864   0.23876    -14.60 2.721e-48  -3.9543    -3.018</span></span>
<span><span class="co">#&gt; 2           A   0.8764   0.08217     10.67 1.469e-26   0.7154     1.038</span></span></code></pre></div>
</div>
</div>
  </main><aside class="col-md-3"><div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php" class="external-link">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing rw</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Lucy D'Agostino McGowan <br><small class="roles"> Author, maintainer </small>   </li>
<li>Suyang Yu <br><small class="roles"> Author </small>   </li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/LucyMcGowan/rw/actions/workflows/R-CMD-check.yaml" class="external-link"><img src="https://github.com/LucyMcGowan/rw/actions/workflows/R-CMD-check.yaml/badge.svg" alt="R-CMD-check"></a></li>
<li><a href="https://app.codecov.io/gh/LucyMcGowan/rw" class="external-link"><img src="https://codecov.io/gh/LucyMcGowan/rw/graph/badge.svg" alt="Codecov test coverage"></a></li>
</ul>
</div>

  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Lucy D’Agostino McGowan, Suyang Yu.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
